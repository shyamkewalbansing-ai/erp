<analysis>**original_problem_statement:**
De gebruiker wil een uitgebreide Boekhouding (Accounting) module bouwen die specifiek is afgestemd op de Surinaamse markt. De kerninstructie is om de structuur en UI van een referentieproject exact te volgen: . Inmiddels is de scope uitgebreid met features zoals PDF-facturen, MT940-import, Surinaamse belastingrapportages, Excel-exports, configureerbare SMTP-instellingen, multi-tenancy, en het automatisch ophalen en inplannen van wisselkoersen van de Centrale Bank van Suriname ().

**PRODUCTVEREISTEN:**
-   **Valuta:** SRD, USD, EUR.
-   **Wisselkoersen:** Zowel handmatige invoer als automatische synchronisatie van .
-   **Thema & UI:** Clean, modern, en professioneel, gebaseerd op de look-and-feel van traditionele boekhoudsoftware (zoals Exact/Twinfield).
-   **Backend:** FastAPI met MongoDB.
-   **Frontend:** React met TailwindCSS.

**User's preferred language**: Dutch

**what currently exists?**
De applicatie is een full-stack React/FastAPI-app. Een groot deel van de boekhoudmodule is geïmplementeerd en functioneel, inclusief een werkende instellingenpagina voor SMTP, een multi-tenant UI voor bedrijvenbeheer, en een complete, geautomatiseerde wisselkoersmodule die data van  schraapt via Playwright en inplant met APScheduler. De vorige agent heeft een grote reeks bugs opgelost die veroorzaakt werden door een mismatch in veldnamen (Engels in de frontend vs. Nederlands in de backend) op diverse pagina's. De  is recentelijk voor een tweede keer volledig herschreven om te voldoen aan de wens van de gebruiker voor een meer traditioneel, zakelijk ontwerp.

**Last working item**:
-   **Last item agent was working:** De agent was bezig met het herontwerpen van de  (klantenpagina). Nadat de eerste professionele make-over werd afgekeurd, heeft de agent de pagina opnieuw herschreven () met een ontwerp dat meer moet lijken op traditionele boekhoudsoftware zoals Exact of Twinfield.
-   **Status:** IN PROGRESS
-   **Agent Testing Done:** N
-   **Which testing method agent to use?** frontend testing agent. De eerste stap is een screenshot maken van de nieuwe  pagina om het nieuwe ontwerp aan de gebruiker te tonen voor goedkeuring.
-   **User Testing Done:** N

**All Pending/In progress Issue list**:
-   **Issue 1: Inconsistentie in datamodel tussen frontend en backend (P0)**
    -   **Beschrijving:** De gekopieerde frontend gebruikt Engelse veldnamen (bv. , ), terwijl de backend Nederlandse veldnamen verwacht (bv. , ). Dit heeft tot meerdere Unknown error en  crashes geleid op verschillende pagina's.
    -   **Status:** IN PROGRESS. Hoewel de vorige agent dit op veel pagina's (, , , etc.) reactief heeft opgelost, blijft dit een systemisch risico. Het probleem is nog niet volledig uitgeroeid en kan op andere pagina's nog bestaan.
    -   **Is recurring issue?** Y

**In progress Task List**:
-   **Task 1: Valideer en voltooi het nieuwe ontwerp van de DebiteurenPage (P0)**
    -   **Where to resume:** Het bestand  is zojuist overschreven. De volgende stap is om via een screenshot te verifiëren of het nieuwe, meer traditionele ontwerp voldoet aan de wensen van de gebruiker.
    -   **What will be achieved with this?** De belangrijkste klantenpagina krijgt een UI die aansluit bij de professionele verwachtingen van de gebruiker.
    -   **Status:** IN PROGRESS
    -   **Should Test frontend/backend/both after fix?** frontend

**Upcoming and Future Tasks**
-   **Upcoming Tasks:**
    -   **Implementeer custom factuur-templates (P1):** De UI-tab bestaat op de instellingenpagina, maar de backend-logica om templates op te slaan en toe te passen op gegenereerde PDF's moet nog worden gebouwd.
-   **Future Tasks:**
    -   **Refactor e-mail services (P2):** Voeg de twee e-maildiensten ( en ) samen tot één configureerbare service.
    -   **Verbeter Multi-tenancy (P2):** Zorg ervoor dat *alle* databasequeries in de applicatie strikt gefilterd worden op het actieve  om dataseparatie te garanderen.
    -   **Los 500-errors op vastgoed-dashboard op (P3):** De  endpoint (voor de vastgoedmodule) geeft 500-errors. Dit is niet kritiek voor de boekhouding, maar moet worden opgelost voor een naadloze app-ervaring.

**Completed work in this session**
-   **Instellingenpagina:** Volledig geïmplementeerd, inclusief tabs voor SMTP-configuratie en bedrijvenbeheer (multi-tenant).
-   **Automatische Wisselkoers-integratie (CME.sr):**
    -   Een scraper () gebouwd met Playwright die wisselkoersen van  haalt.
    -   Een scheduler ( met APScheduler) ingesteld die dagelijks om 9:00, 10:00 en 11:00 (SRT) de koersen synchroniseert.
    -   De  uitgebreid met een handmatige sync-knop, een statusindicator voor de scheduler, en weergave van de gesynchroniseerde koersen.
-   **Kritieke Bugfixes:**
    -   Een  opgelost op de ,  en .
    -   403 Forbidden-errors opgelost door de  en  van de demogebruiker in de database te corrigeren.
    -   Meerdere Unknown error meldingen opgelost door de Engelse/Nederlandse veldnamen (/) te mappen in de API-calls op de , , , ,  en .
-   **Testing Agent Succesvol:** De testing agent is ingezet () en alle tests slaagden op dat moment.

**Earlier issues found/mentioned but not fixed**
-   De  endpoint (voor de vastgoedmodule) crasht met een 500 server error. Dit is genegeerd omdat het buiten de scope van de boekhoudmodule viel, maar het beïnvloedt de algehele gebruikerservaring bij het inloggen.

**Known issue recurrence from previous fork**
-   **Issue:** Inconsistentie tussen de frontend (gebaseerd op een Engelse referentie-repo) en de Nederlandse backend. Dit blijft de voornaamste bron van bugs.
-   **Recurrence count:** Hoog
-   **Status:** IN PROGRESS. De aanpak is reactief (pagina voor pagina oplossen). Een proactieve, systeembrede oplossing is nog niet geïmplementeerd.

**Code Architecture**


**Key Technical Concepts**
-   **Backend:** FastAPI, MongoDB, APScheduler, Playwright
-   **Frontend:** React, TailwindCSS, Recharts
-   **Kernprobleem:** Een mismatch in datamodellen (Engelse vs. Nederlandse veldnamen) tussen de frontend en de backend.

**key DB schema**
-   ****: De velden  en een geldige  zijn cruciaal voor de authenticatie-middleware om 403-fouten te voorkomen.
-   ****: Collectie voor de multi-tenant functionaliteit.
-   ****: Slaat nu ook  ('inkoop'/'verkoop') en  ('CME.sr') op.

**changes in tech stack**
-   ****: Toegevoegd aan de backend voor het scrapen van JavaScript-gerenderde webpagina's.
-   ****: Toegevoegd aan de backend voor het inplannen van achtergrondtaken.

**All files of reference**
-   **Huidige focus:**  (is net herschreven).
-   **Nieuwe backend services:** , .
-   **Recent gewijzigd (bugs):** , , , , en diverse andere pagina's in .
-   **Backend aanpassingen:**  (integratie scheduler),  (nieuwe endpoints).

**Areas that need refactoring**:
-   Een centrale oplossing voor de vertaling van veldnamen (Engels ↔ Nederlands) is nodig om de constante stroom van gerelateerde bugs te stoppen. Dit kan in  of via een gedeelde utility-functie.

**key api endpoints**
-   : Start de wisselkoers-scraper.
-   : Vraagt de status van de geplande taken op.
-   : De correcte endpoint voor producten (die in de frontend 'products' werden genoemd).

**Critical Info for New Agent**
-   **Prioriteit 1: Valideer het nieuwe  ontwerp.** De gebruiker is zeer specifiek over de UI. Maak direct een screenshot en vraag om goedkeuring.
-   **Wees alert op veldnaam-bugs.** Het  vs.  probleem is de hoofdoorzaak van de meeste recente bugs. Controleer bij elke nieuwe taak of wijziging of de data-objecten correct gemapt worden tussen frontend en backend. Overweeg een structurele oplossing voor te stellen.
-   **Authenticatie is gevoelig.** De  gebruiker moet een actieve  en een  in de toekomst hebben, anders faalt de authenticatie-middleware voor bepaalde API-calls.

**documents and test reports created in this job**
-   

**Last 10 User Messages and any pending HUMAN messages**
1.  **User (pending):** Heeft gevraagd om een meer traditioneel, echt boekhouding design voor de Debiteuren-pagina. **Status: IN PROGRESS**.
2.  **User:** Bevestigde dat de app werkte na een reeks bugfixes. **Status: COMPLETED**.
3.  **User:** Rapporteerde een  op de . **Status: RESOLVED**.
4.  **User:** Rapporteerde dat het aanmaken van Producten en BTW-codes niet werkte. **Status: RESOLVED**.
5.  **User:** Rapporteerde een  op de . **Status: RESOLVED**.
6.  **User:** Gaf akkoord voor het dagelijks syncen van wisselkoersen. **Status: COMPLETED**.
7.  **User:** Stelde de verbetering voor om wisselkoersen automatisch van  te halen. **Status: COMPLETED**.
8.  **User:** Vroeg om zowel inkoop- als verkoopkoersen op te slaan. **Status: COMPLETED**.
9.  **User:** Gaf akkoord om verder te gaan met een taak. **Status: COMPLETED**.
10. **User:** Vroeg om een professioneler design voor de Debiteuren-pagina. **Status: IN PROGRESS**.

**Project Health Check:**
-   **Broken:** De  is in een ongeteste staat na een volledige rewrite. De systemische inconsistentie in veldnamen vormt een risico voor de stabiliteit van de hele applicatie.
-   **Mocked:** Geen.

**3rd Party Integrations**
-   **playwright:** (v1.44.0) Voor web scraping.
-   **APScheduler:** (v3.11.2) Voor achtergrondtaken.
-   **recharts:** (v3.7.0) Voor grafieken.
-   **mt940:** (v0.7.0) Voor bankbestanden.
-   **reportlab:** (v4.4.9) Voor PDF's.
-   **openpyxl:** (v3.1.5) Voor Excel.
-   **aiosmtplib:** (v5.1.0) Voor e-mail.

**Testing status**
-   **Testing agent used after significant changes:** YES
-   **Troubleshoot agent used after agent stuck in loop:** NO
-   **Test files created:** []
-   **Known regressions:** De kernfunctionaliteit (items aanmaken) was recentelijk stuk door de veldnaam-mismatch en is grotendeels hersteld.

**Credentials to test flow:**
-   **Gebruikersnaam:** 
-   **Wachtwoord:** 

**What agent forgot to execute**
De agent heeft het kernprobleem van de veldnaam-mismatch reactief en ad-hoc opgelost per pagina. Een proactieve, systeembrede audit en een structurele oplossing zijn niet geïmplementeerd, waardoor het probleem bleef terugkeren op nieuwe locaties.</analysis>
